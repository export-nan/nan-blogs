---
title: 关于 zsh 命令行工具启动慢的问题
date: 2026-02-02
category: 
  - 日常记录
---

最近遇到启动命令行工具加载慢的问题，表现为每次打开一个新的zsh终端窗口时，需要等待几秒钟才能看到命令提示符。
目标为找到是那些启动依赖导致加载慢的。

首先在 .zshrc 顶部加上：

```shell
zmodload zsh/zprof
```

在 .zshrc 末尾加上：

```shell
zprof
```

然后重新打开一个终端，会自动打印出：

```shell
num  calls                time                       self            name
-----------------------------------------------------------------------------------
1)    1         300.45    300.45   51.85%     300.45   51.85%  eval
2)    1         180.02    180.02   31.10%     180.02   31.10%  pyenv init
3)    1          60.01     60.01   10.36%      60.01   10.36%  oh-my-zsh.sh
```

这里可以看到是什么在导致加载慢，然后根据提示去优化。绝大多少情况下都是再.zshrc中有一些插件或者命令导致加载慢，比如我这里就是pyenv init导致加载慢，因为pyenv init会加载很多python的版本，导致加载慢，所以这里可以尝试注释掉pyenv init，去掉后再打开终端，发现加载速度明显提升。
